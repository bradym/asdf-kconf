#!/usr/bin/env bash

set \
    -o errexit \
    -o nounset \
    -o pipefail

readonly repository="particledecay/kconf"

cmd="curl -s"
if [ -n "${OAUTH_TOKEN:-}" ]; then
    cmd="$cmd -H 'Authorization: token $OAUTH_TOKEN'"
fi
cmd="$cmd https://api.github.com/repos/$repository/releases"
versions=$(eval $cmd | grep tag_name | sed 's/"tag_name": //g;s/"//g;s/,//g' | sed -e 's/v//g' -e '/1.6.0/q' | tac)
echo $versions
